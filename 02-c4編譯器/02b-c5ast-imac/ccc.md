修改自 https://github.com/rswier/c4/blob/c5-AST/c5.c
